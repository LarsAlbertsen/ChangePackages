<?xml version="1.0" encoding="UTF-8"?>
<STEP-ProductInformation ContextID="Context1" WorkspaceID="Main" UseContextLocale="false">
    <BusinessRules>
        <BusinessRule ID="UpdateChangePackage" Scope="Global" Type="Action" RunPrivileged="false"><!-- Definition:
Action #1 (JavaScriptBusinessActionWithBinds):
<config>
  <bindings>
    <binding alias="node" type="Node" contract="CurrentObjectBindContract"/>
    <binding alias="logger" type="Logger" contract="LoggerBindContract"/>
    <binding alias="manager" type="Manager" contract="ManagerBindContract"/>
  </bindings>
  <messages/>
  <javaScript>
logger.info("AutoUpdateEP " + node)

if (node != null) {
	/** @type{ChangePackageHome} */
	var cpHome = manager.getHome(com.stibo.core.domain.changepackage.ChangePackageHome)
	var cp = cpHome.getChangePackageByID("ChangedItems")

	if (!isOpen(cp)) {
		log.info("AddToChangePackage Reopen")
		cp.reOpen()
	}

	logger.info("AddToChangePackage "+node.getClass().getName())
	if (node instanceof com.stibo.core.domain.AttributeGroup ||
		node instanceof com.stibo.core.domain.setupgroup.SetupGroup) {
		logger.info("AddToChangePackage addHierarchy")
		cp.addHierarchy(node)
	}
	else {
		logger.info("AddToChangePackage addItem")
		cp.addItem(node)
	}
}

/**
 * 
 * @param {ChangePackage} pCP 
 * @returns {boolean}
 */
function isOpen(pCP) {
	var state = pCP.getValue("ChangePackageState").getSimpleValue()
	logger.info("AddToChangePackage state = " + state)
	if ("Change Package (Sealed)".equals(state)) {
		logger.info("isOpen(" + pCP.getName() + " false")
		return false
	}
	logger.info("isOpen(" + pCP.getName() + " true")
	return true;
}
  </javaScript>
</config> -->
            <SetupGroupLink SetupGroupID="TrackChanges"></SetupGroupLink>
            <Name QualifierID="Qualifier root">Update ChangePackage</Name>
            <OnApprove ApproveSetup="Never"></OnApprove>
            <Configuration>H4sIAAAAAAAAALVWTVPbMBA9x79C+MDYYeq0t86QAEmgLR0oGQLtkVHsjRFVJCHJTCnw37uylA8XmEA/DpmRdlfv7b5dRVa8Kpm4oEpxBuaCTS9yKaas7HV3f8w4uQFtmBS9+F32NiYgclkwUfbi87MPb97HuztRd1AZJsCY04pDB/cGgeyO8rB/gbUTEbIwjGo4sur3psP9XvyZ3tBxrpmyc38/t0j0jdnLAROFiR0Woo2opjOwmIY3rJqIQ/LR5OxWQS++QtiMU1FmY6sx0Xhnk9vtRiWb15W021iOXyxr8vu6ML/c3SztduQAHMcxVfWekLmFoFJW09xiGv7EsNIahD2ZXEFuXcgwRASuPmfUhFghCwjmRUFDTs3CX3HuV521vEeyLEGvIeR10L+iPKaCruec+ajXkDrKzqrg3c7i3DMjcKC11Mc4Q8j1v0fhSOaUs590wiEwnsFMcWphUIkCr9MLc15egOcT9h3LmJjKxOfRr6w8VwWyHYxIyHqLuFFKo4hNSeKWZKNHnKopuYtanXab7FkkuBteIjaMaP4dk/4kZ/BA2p2odUM1yZXbkx4J/cpKsM6S5HKWGcsmMsulhqyQM8pEltdIyiNlj3DTOSgCemSH1wgb3B7uh5K8vTi0MDPegqW0XC0bzJwoEEmu0rqUFurREKMozmQDlpyCxBNzmFYrV5mGGgR3D4j7hKSPUbxjy2lZZ+6mNUnd8gt2MElTn1+tNRPGUpGDnJKnxepb7OaksvBRy0qR+3tM62UnDdhKle5UNnbLGmChxPoyaFF8YqCpzi9vG5KsOhI/PChOC7iBV6G7nv0O7GxLTJQcBzAibeJ+e8pdAdKcxAeihiPv1lilFobcTaTkQMVD5CZ0Won6aSBhHDC8FsHNGCpo3dyizbXnK+UVNOYqkIxdXEjVBY4Z3lnw4ekLp2LOtbh2tSHMwionmZ9IxkA5FKl3ZnBdUW4Sf+y5PoYiFyShMj94uA+OKSLBUnuvnLfWvfxjYKurJW6AdbZt18tHf2srhvp97naarz9+H3SaHwjhW+MX79KfXcMIAAA=</Configuration>
            <ValidObjectTypes AllObjectTypesValid="true"></ValidObjectTypes>
        </BusinessRule>
    </BusinessRules>
</STEP-ProductInformation>